<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>Редагувати профіль</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
* { box-sizing: border-box; font-family: 'Montserrat', sans-serif; }

body {
  margin: 0;
  background: #D0E6FD;
  display: flex;
  min-height: 100vh;
}

/* ===== SIDEBAR (ТОЧНО ЯК HOME) ===== */
.sidebar {
  width: 240px;
  background: #f2f4f7;
  padding: 30px 20px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.logo {
  text-align: center;
  margin-bottom: 40px;
}

.logo img {
  width: 90px;
}

.nav {
  display: flex;
  flex-direction: column;
  gap: 22px;
}

.nav a {
  text-decoration: none;
  color: #333;
  font-size: 15px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.profile-link {
  display: flex;
  align-items: center;
  gap: 10px;
  text-decoration: none;
  color: #333;
}

.profile-link img {
  width: 34px;
  height: 34px;
  border-radius: 50%;
  object-fit: cover;
}

/* ===== MAIN ===== */
.main {
  flex: 1;
  padding: 30px;
}

.bio-hint {
  font-size: 12px;
  color: #2c2c2c;
  opacity: 0.7;
  margin-top: 6px;
  max-width: 420px;
  line-height: 1.4;
  text-align: left;
  margin-left: auto;
  margin-right: auto;
}

/* ===== PROFILE CARD ===== */
.profile-card {
  background: transparent;
  border-radius: 0;
  padding: 30px 40px;
}

/* HEADER */
.profile-header h2 {
  margin: 0;
  font-size: 22px;
  font-weight: 700;
}

.actions {
  display: flex;
  gap: 12px;
  margin-bottom: 56px;
}

.actions button {
  padding: 10px 18px;
  border-radius: 12px;
  border: none;
  font-weight: 600;
  cursor: pointer;
}

.cancel {
  background: #eef3fa;
}

.save {
  background: #0A1B58;
  color: #fff;
}

/* GRID */
.profile-grid {
  display: grid;
  grid-template-columns: 260px 1fr 1fr;
  gap: 24px;
}

/* PHOTO */
.photo-block {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.photo-block img,
.photo-placeholder {
  width: 150px;
  height: 150px;
  border-radius: 50%;
  object-fit: cover;
  margin-bottom: 16px;
}

.section {
  margin-bottom: 18px;
}

.photo-block button {
  width: 100%;
  padding: 14px 16px;
  border-radius: 12px;
  border: none;
  background: #0A1B58;
  color: #fff;
  font-weight: 600;
  font-size: 15px;
  line-height: 20px;
  cursor: pointer;
  margin-bottom: 8px;
}

.photo-block input {
  display: none;
}

.photo-placeholder {
  width: 140px;
  height: 140px;
  border-radius: 50%;
  background: #eef3fa;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 48px;
  color: #0A1B58;
  font-weight: 600;
  margin-bottom: 12px;
}

.sidebar-avatar {
  width: 34px;
  height: 34px;
  border-radius: 50%;
  background: #d0d8e6;
}

/* FIELDS */
label {
  font-size: 13px;
  font-weight: 600;
  margin-bottom: 6px;
  display: block;
}

input, textarea {
  width: 100%;
  padding: 14px;
  border-radius: 14px;
  border: none;
  margin-bottom: 16px;
  background: #fff;
  font-size: 14px;
}

textarea {
  min-height: 110px;
  resize: none;
}

.logout-btn {
  padding: 10px 18px;
  border-radius: 12px;
  background: #ffe3e3;
  color: #b30000;
  font-weight: 600;
  font-size: 14px;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
}

.logout-btn:hover {
  background: #ffcccc;
}

.chips {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 10px;
}

.chip {
  background: #fff;
  border-radius: 999px;
  padding: 8px 14px;
  font-size: 13px;
  display: flex;
  align-items: center;
  gap: 6px;
  cursor: default;
}

.chip span {
  font-weight: 600;
}

.chip button {
  background: none;
  border: none;
  font-size: 14px;
  cursor: pointer;
  color: #666;
}

.add-chip {
  background: #eaf1ff;
  font-weight: 700;
  cursor: pointer;
}

.section-title {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 10px;
}

.add-plus {
  width: 26px;
  height: 26px;
  border-radius: 8px;
  background: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  font-weight: 700;
  cursor: pointer;
}
.dropdown {
  background: #fff;
  border-radius: 14px;
  padding: 8px;
  margin-top: 8px;
  box-shadow: 0 10px 30px rgba(0,0,0,.12);
  max-width: 300px;
}

.dropdown.hidden {
  display: none;
}

.dropdown-item {
  padding: 8px 12px;
  border-radius: 10px;
  font-size: 13px;
  cursor: pointer;
}

.dropdown-item:hover {
  background: #eaf1ff;
}

.birth-row {
  display: flex;
  gap: 5px;
  margin-bottom: 18px;
}

.birth-row select {
  flex: 1;
  padding: 14px;
  border-radius: 14px;
  border: none;
  background: #fff;
}

.gender-switch {
  display: flex;
  background: #e3ebf5;
  border-radius: 14px;
  padding: 4px;
  margin-bottom: 18px;
  width: 100%;
  max-width: 420px;
}

.gender-option {
  flex: 1;
  text-align: center;
  padding: 12px 0;
  border-radius: 12px;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  color: #333;
  transition: .18s;
}

.gender-option.active {
  background: #0A1B58;
  color: white;
  box-shadow: 0 6px 18px rgba(11,44,134,.25);
}

.gender-option:hover {
  opacity: .85;
}

.actions {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 56px;
}

.left-actions {
  display: flex;
  gap: 12px;
}


/* БІЛИЙ ХЕДЕР */
.profile-header {
  background: #ffffff;
  padding: 18px 28px;
  border-radius: 18px;
  margin-bottom: 28px;
  box-shadow: 0 10px 25px rgba(0,0,0,.08);
}

/* вирівнювання кнопок */
.actions {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.left-actions {
  display: flex;
  gap: 12px;
}

.sidebar-bottom{
  display:flex;
  flex-direction:column;
  gap:12px;
}

.logout-link{
  margin-top:10px;
  padding:10px;
  border-radius:12px;
  background:#ffe3e3;
  color:#b30000;
  text-decoration:none;
  font-weight:600;
  text-align:center;
}

.login-link, .register-link{
  padding:10px;
  border-radius:12px;
  background:#0A1B58;
  color:white;
  text-decoration:none;
  text-align:center;
  font-weight:600;
}


/* SIDEBAR */
.sidebar {
  width: 300px;
  background: #f4f5f6;
  padding: 32px 36px 30px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.logo {
  display: flex;
  justify-content: center;
  margin-bottom: 34px;
}

.logo-img {
  width: 126px;
  height: auto;
}

.nav {
  display: flex;
  flex-direction: column;
  gap: 34px;
}

.nav a {
  text-decoration: none;
  display: flex;
  align-items: center;
  gap: 16px;
  font-size: 0;
}

.nav a img {
  width: 30px;
  height: 30px;
  object-fit: contain;
  opacity: .72;
}

.nav-text {
  color: #2d3138;
  font-size: 16px;
  line-height: 22px;
  font-weight: 500;
  letter-spacing: -0.18px;
}

.nav a.active .nav-text {
  color: #0f1114;
  font-weight: 600;
}

.nav a.active img {
  opacity: 1;
}

.profile {
  display: flex;
  align-items: center;
  gap: 12px;
  text-decoration: none;
  color: #2d3138;
}

.profile img {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  object-fit: cover;
}

.sidebar-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: #d4d9e1;
}

.profile-name {
  font-size: 16px;
  line-height: 22px;
  font-weight: 500;
  letter-spacing: -0.18px;
}

.profile span {
  font-size: 16px;
  line-height: 22px;
  font-weight: 500;
  letter-spacing: -0.18px;
}

/* Sidebar style equal to messages page */
.mini-sidebar{
  width:112px;
  background:#f6f6f6;
  border-right:1px solid #d8d8d8;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:space-between;
  padding:16px 0 20px;
}

.mini-top{
  width:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
}

.mini-logo{
  width:78px;
  height:auto;
}

.mini-nav{
  width:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:flex-start;
  gap:24px;
  margin-top:16px;
}

.mini-link{
  width:44px;
  height:44px;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:12px;
}

.mini-link-icon{
  width:34px;
  height:34px;
  object-fit:contain;
  opacity:.72;
}

.mini-link.active .mini-link-icon{opacity:1}

.mini-user img,.mini-avatar{
  width:44px;
  height:44px;
  border-radius:50%;
  object-fit:cover;
}

.mini-avatar{background:#cfd5df}

/* Top header like reference */
.main{
  flex:1;
  padding:0;
}

.edit-header{
  height:126px;
  background:#f6f6f6;
  border-bottom:1px solid #b9c2cf;
  padding:0 34px 0 56px;
  display:flex;
  align-items:center;
  justify-content:space-between;
}

.edit-header-left{
  display:flex;
  align-items:center;
  gap:26px;
}

.edit-back{
  border:none;
  background:transparent;
  color:#101217;
  font-size:56px;
  line-height:1;
  font-weight:400;
  cursor:pointer;
  padding:0;
  display:flex;
  align-items:center;
  justify-content:center;
  transform:translateY(-3px);
}

.edit-title{
  font-size:36px;
  line-height:1.05;
  font-weight:600;
  color:#101217;
}

.edit-header-actions{
  display:flex;
  align-items:center;
  gap:14px;
}

.edit-cancel,
.edit-save{
  border:none;
  border-radius:14px;
  padding:12px 22px;
  font-size:14px;
  line-height:20px;
  font-weight:600;
  cursor:pointer;
}

.edit-cancel{
  background:#C8C8C8;
  color:#111319;
}

.edit-save{
  background:#0A1B58;
  color:#fff;
}

.edit-logout{
  border:none;
  border-radius:14px;
  padding:12px 22px;
  font-size:14px;
  line-height:20px;
  font-weight:600;
  background:#ffe3e3;
  color:#8f1111;
  text-decoration:none;
}

.profile-card{
  padding:28px 40px 30px;
}


</style>
</head>

<body>

<!-- SIDEBAR -->
<aside class="mini-sidebar">
  <div class="mini-top">
    <img src="/images/logo-2.png" alt="SoulLink" class="mini-logo">
    <nav class="mini-nav">
      <a class="mini-link" href="{% if request.session.user_id %}/dating/{% else %}/login/{% endif %}" aria-label="Знайомства">
        <img class="mini-link-icon" src="/images/icons/codicon_home.svg" alt="">
      </a>
      <a class="mini-link" href="{% if request.session.user_id %}/sympathy{% else %}/login/{% endif %}" aria-label="Симпатії">
        <img class="mini-link-icon" src="/images/icons/system-uicons_chain.svg" alt="">
      </a>
      <a class="mini-link" href="{% if request.session.user_id %}/likes/{% else %}/login/{% endif %}" aria-label="Лайки">
        <img class="mini-link-icon" src="/images/icons/solar_heart-linear.svg" alt="">
      </a>
      <a class="mini-link" href="/messages/" aria-label="Повідомлення">
        <img class="mini-link-icon" src="/images/icons/ph_paper-plane-tilt-light.svg" alt="">
      </a>
    </nav>
  </div>
  <a class="mini-user" href="/profile/" aria-label="Профіль">
    {% if user and user.photo %}
      <img src="{{ user.photo.url }}" alt="{{ user.name }}">
    {% else %}
      <div class="mini-avatar"></div>
    {% endif %}
  </a>
</aside>

<!-- MAIN -->
<div class="main">

<form method="POST" enctype="multipart/form-data">
{% csrf_token %}

<div class="edit-header">
  <div class="edit-header-left">
    <button class="edit-back" type="button" onclick="history.back()" aria-label="Назад">‹</button>
    <h1 class="edit-title">Редагувати профіль</h1>
  </div>
  <div class="edit-header-actions">
    <button type="button" class="edit-cancel" onclick="location.href='/'">Скасувати зміни</button>
    <button type="submit" class="edit-save">Зберегти зміни</button>
    <a href="/logout/" class="edit-logout">Вийти</a>
  </div>
</div>

<div class="profile-card">

  <!-- GRID -->
  <div class="profile-grid">

<!-- PHOTO -->
<div class="photo-block">

  {% if user.photo %}
    <img id="photoPreview" src="{{ user.photo.url }}">
  {% else %}
    <div id="photoPreview" class="photo-placeholder">+</div>
  {% endif %}

  <label>
    <button type="button" onclick="document.getElementById('photoInput').click()">
      Завантажити нове фото
    </button>
    <input
      type="file"
      name="photo"
      id="photoInput"
      accept="image/*"
      style="display:none"
    >
  </label>

</div>

<!-- COL 1 -->
<div>

  <label>Імʼя</label>
  <input name="name" value="{{ user.name }}">

<label>Стать</label>

<div class="gender-switch">
  <div class="gender-option {% if user.gender != 'Жінка' %}active{% endif %}" data-value="Чоловік">
    Чоловік
  </div>
  <div class="gender-option {% if user.gender == 'Жінка' %}active{% endif %}" data-value="Жінка">
    Жінка
  </div>
</div>

<input type="hidden" name="gender" id="genderInput" value="{{ user.gender|default:'Чоловік' }}">


  <label>Місто</label>
  <input name="city" value="{{ user.city }}">

  <label>Дата народження</label>
  <div class="birth-row">

    <select name="birth_day">
      {% for d in days %}
        <option value="{{ d }}" {% if user.birth_date and user.birth_date.day == d %}selected{% endif %}>
          {{ d|stringformat:"02d" }}
        </option>
      {% endfor %}
    </select>

    <select name="birth_month">
      {% for m in months %}
        <option value="{{ m.0 }}" {% if user.birth_date and user.birth_date.month == m.0 %}selected{% endif %}>
          {{ m.1 }}
        </option>
      {% endfor %}
    </select>

    <select name="birth_year">
      {% for y in years %}
        <option value="{{ y }}" {% if user.birth_date and user.birth_date.year == y %}selected{% endif %}>
          {{ y }}
        </option>
      {% endfor %}
    </select>

  </div>

</div>


<!-- ===== COL 2 (ВИПРАВЛЕНО ВІДСТУПИ) ===== -->
<div>

  <!-- BIO -->
  <div style="margin-bottom:30px;">
    <label>Про мене</label>
    <textarea name="bio">{{ user.bio }}</textarea>

    <div class="bio-hint" style="margin-top:10px;">
      Не вказуй конфіденційної інформації, свої соцмережі, інтимні вподобання та інше,
      що не входить у наші правила спільноти. Така інформація буде видалена.
    </div>
  </div>


  <!-- INTERESTS -->
  <div style="margin-bottom:30px;">
    <label class="section-title">
      Інтереси
      <span id="addInterest" class="add-plus">+</span>
    </label>

    <div class="chips" id="interestsChips"></div>

    <div id="interestDropdown" class="dropdown hidden">
      <div class="dropdown-item">Мистецтво</div>
      <div class="dropdown-item">Кіно</div>
      <div class="dropdown-item">Їжа</div>
      <div class="dropdown-item">Музика</div>
      <div class="dropdown-item">Книги</div>
      <div class="dropdown-item">Спорт</div>
      <div class="dropdown-item">Ігри</div>
      <div class="dropdown-item">Подорожі</div>
      <div class="dropdown-item">Фотографія</div>
      <div class="dropdown-item">Велоспорт</div>
      <div class="dropdown-item">Театр</div>
      <div class="dropdown-item">Вечірки</div>
    </div>

    <input type="hidden" name="interests" id="interestsInput">
  </div>


  <!-- LIFESTYLE -->
  <div style="margin-bottom:30px;">
    <label class="section-title">
      Стиль життя
      <span id="addLifestyle" class="add-plus">+</span>
    </label>

    <div class="chips" id="lifestyleChips"></div>

    <div id="lifestyleDropdown" class="dropdown hidden">
      <div class="dropdown-item">Активний</div>
      <div class="dropdown-item">Домашній</div>
      <div class="dropdown-item">Творчий</div>
      <div class="dropdown-item">Соціальний</div>
      <div class="dropdown-item">Спортсмен</div>
      <div class="dropdown-item">Тусовщик</div>
      <div class="dropdown-item">Розмірений</div>
      <div class="dropdown-item">Мандрівник</div>
    </div>

    <input type="hidden" name="lifestyle" id="lifestyleInput">
  </div>

</div>


</form>
</div>

<script>
const input = document.getElementById('photoInput');
const preview = document.getElementById('photoPreview');

if (input) {
  input.addEventListener('change', () => {
    const file = input.files[0];
    if (!file) return;

    const url = URL.createObjectURL(file);

    // якщо вже є <img>
    if (preview.tagName === 'IMG') {
      preview.src = url;
    } else {
      const img = document.createElement('img');
      img.src = url;
      img.id = 'photoPreview';
      img.style.width = '140px';
      img.style.height = '140px';
      img.style.borderRadius = '50%';
      img.style.objectFit = 'cover';

      preview.replaceWith(img);
    }
  });
}
</script>


<script>
const chipsBox = document.getElementById("interestsChips");
const addBtn = document.getElementById("addInterest");
const dropdown = document.getElementById("interestDropdown");
const hiddenInput = document.getElementById("interestsInput");

let selected = "{{ user.interests|default:'' }}"
  .split(",")
  .map(i => i.trim())
  .filter(Boolean);

function render() {
  chipsBox.innerHTML = "";
  selected.forEach(val => {
    const chip = document.createElement("div");
    chip.className = "chip";
    chip.innerHTML = `<span>${val}</span><button type="button">×</button>`;
    chip.querySelector("button").onclick = () => {
      selected = selected.filter(i => i !== val);
      update();
    };
    chipsBox.appendChild(chip);
  });
}

function update() {
  hiddenInput.value = selected.join(", ");
  render();
}

addBtn.onclick = () => {
  dropdown.classList.toggle("hidden");
};

document.querySelectorAll(".dropdown-item").forEach(item => {
  item.onclick = () => {
    const value = item.textContent;
    if (!selected.includes(value)) {
      selected.push(value);
      update();
    }
    dropdown.classList.add("hidden");
  };
});

update();


// -------- LIFESTYLE --------
const lifestyleBox = document.getElementById("lifestyleChips");
const lifestyleBtn = document.getElementById("addLifestyle");
const lifestyleDropdown = document.getElementById("lifestyleDropdown");
const lifestyleInput = document.getElementById("lifestyleInput");

let lifestyle = "{{ user.lifestyle|default:'' }}"
  .split(",")
  .map(i => i.trim())
  .filter(Boolean);

function renderLifestyle() {
  lifestyleBox.innerHTML = "";
  lifestyle.forEach(val => {
    const chip = document.createElement("div");
    chip.className = "chip";
    chip.innerHTML = `<span>${val}</span><button type="button">×</button>`;
    chip.querySelector("button").onclick = () => {
      lifestyle = lifestyle.filter(i => i !== val);
      updateLifestyle();
    };
    lifestyleBox.appendChild(chip);
  });
}

function updateLifestyle() {
  lifestyleInput.value = lifestyle.join(", ");
  renderLifestyle();
}

lifestyleBtn.onclick = () => {
  lifestyleDropdown.classList.toggle("hidden");
};

lifestyleDropdown.querySelectorAll(".dropdown-item").forEach(item => {
  item.onclick = () => {
    const value = item.textContent;
    if (!lifestyle.includes(value)) {
      lifestyle.push(value);
      updateLifestyle();
    }
    lifestyleDropdown.classList.add("hidden");
  };
});

updateLifestyle();
</script>

<script>
const genderOptions = document.querySelectorAll(".gender-option");
const genderInput = document.getElementById("genderInput");

genderOptions.forEach(btn=>{
  btn.onclick=()=>{
    genderOptions.forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
    genderInput.value=btn.dataset.value;
  };
});
</script>




</body>
</html>
